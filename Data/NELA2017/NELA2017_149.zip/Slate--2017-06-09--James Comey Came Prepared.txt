The most striking thing James Comey revealed in his testimony before the Senate Intelligence Committee on Thursday is that he spent months preparing for it. From the moment he met Donald Trump on Jan. 6, Comey saw what Trump was, and he armed himself. Comey built an arsenal of evidence, and in the past two days, he has deployed it with lethal intent.

On May 16, when the New York Times reported contents of a Comey memo documenting a meeting with Trump, we learned that Comey had created a “paper trail” on Trump’s attempts to subvert FBI investigations. In his written testimony, released Wednesday, Comey revealed that he had been gathering material since Jan. 6. That day, after briefing then-President-elect Trump on the U.S. intelligence report about Russia’s election interference, Comey immediately typed up notes about the meeting. He did the same thing on Jan. 27, after Trump requested his “loyalty” at a private dinner.

At Thursday’s hearing, Comey offered more detail and explanation about why he created this paper trail. He said he documented the Jan. 6 conversation based on a “gut feeling” about “the nature of the person” he had just met. “I was honestly concerned he might lie about the nature of our meeting,” said the former FBI director. So he wrote it all down.

In his written testimony, Comey described extensive discussions with his FBI leadership team after a Feb. 14 meeting in which Trump, after clearing the room of other officials, asked Comey to lay off Trump’s recently ousted national security adviser, Michael Flynn. Comey wrote a memo on the encounter and made sure the memo was unclassified, so it could be more easily shared. At the hearing, Comey said he and his team “decided the best move would be to hold [the memo], keep it in a box.” He suggested that he had concealed Trump’s improper request from other people in the White House in part because Trump or his aides might become FBI targets. “I wouldn’t want to alert the White House it had happened,” Comey said of Trump’s request about Flynn, “until we figured out what we were going to do with it investigatively.”

Comey didn’t just stow memos at the FBI. He gave at least one copy to Daniel Richman, a friend who teaches at Columbia Law School. On May 12, when Trump tweeted a warning that “James Comey better hope that there are no ‘tapes’ of our conversations before he starts leaking to the press,” Comey was ready. He asked Richman, by his own admission, “to share the content of the memo with a reporter.” Comey explicitly testified that he did this to trigger an escalation: “I asked him to because I thought that might prompt the appointment of a special counsel.”

At Thursday’s hearing, Comey arrived with a well-rehearsed case against the president. His opening statement was the work of a prosecutor. He detailed Trump’s “shifting explanations” for firing him. He pointed to Trump’s most self-incriminating statements: that he “fired me because of the Russia investigation” and that he said “my firing had relieved great pressure on the Russian investigation.” He noted that Trump’s excuse about firing Comey over the Hillary Clinton email investigation didn’t fit Trump’s statements to and about him afterward. Again and again, as he responded to senators’ questions, Comey returned to these points. “I take the president at his word, that I was fired because of the Russia investigation,” said Comey. “Something about the way I was conducting it, the president felt, created pressure on him that he wanted to relieve.”

Comey also made a case for his own credibility as a witness, in contrast with the untrustworthiness of the opposing witness, Trump. “In looking at any witness, you look at consistency, track record, demeanor,” said the former FBI director. He pointed to behavior by Trump that others, too, had witnessed: “Why did he kick everybody out of the Oval Office? Why would you kick the attorney general, the [vice] president, the chief of staff out, to talk to me, if it was about something else? … That, to me, as an investigator, is a very significant fact.”

Some Republicans on the committee yielded to Comey without resistance. Some challenged him on a few points, with little enthusiasm or success. By the time he concluded, the panel’s chairman, Sen. Richard Burr, saw no need to feign doubt about Comey’s veracity. “We’re grateful to you for your service to your country,” he told Comey, “not just in the capacity as FBI director, but as a prosecutor, and more importantly, being somebody that loves this country enough to tell it like it is.”

Two hours after the hearing ended, Trump’s lawyer, Marc Kasowitz, gave a six-minute press conference purporting to rebut Comey. Kasowitz took no questions and presented no documentation, contemporaneous or otherwise. He offered no testimony from his client, orally or in writing. Trump’s only written statement remains the May 9 letter in which he asserted that Comey had told him “on three separate occasions that I am not under investigation.” That letter, as poorly thought-out as everything else Trump has done, effectively waived the executive privilege Kasowitz tried to invoke Thursday.

According to Kasowitz, the memos Comey wrote and released expose the then–FBI director as a prejudiced conspirator. But Comey’s wariness of Trump was earned, and he did nothing to hurt the president. In fact, he kept quiet about Trump’s improper attempts to influence him. All Comey did was collect evidence in case Trump committed a crime or lied about their encounters. When Trump fired Comey out of frustration with the Russia investigation, the president brought down that mountain of evidence on himself.

On Jan. 6, when Trump and Comey met, one of them figured out the other right away. Immediately after the meeting, Comey went to his car and started typing his first memo, building the evidence he would need in the event of national or personal betrayal. Trump, on the other hand, took months to realize he had misjudged Comey. In their last conversation on April 11, Trump was still pleading for the blind loyalty he thought Comey had promised him. “We had that thing, you know,” said the president. What Comey had for Trump was another thing coming.